<!doctype html><html lang=zh-cn class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.1"><link rel=canonical type=text/html href=/zh-cn/documentation/grid/><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Grid | Selenium</title><meta name=description content="要在多台计算机上并行运行测试吗? 那么, Grid正是为你准备的.
"><meta property="og:title" content="Grid"><meta property="og:description" content="要在多台计算机上并行运行测试吗? 那么, Grid正是为你准备的.
"><meta property="og:type" content="website"><meta property="og:url" content="/zh-cn/documentation/grid/"><meta property="og:site_name" content="Selenium"><meta itemprop=name content="Grid"><meta itemprop=description content="要在多台计算机上并行运行测试吗? 那么, Grid正是为你准备的.
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Grid"><meta name=twitter:description content="要在多台计算机上并行运行测试吗? 那么, Grid正是为你准备的.
"><link rel=preload href=/scss/main.min.9dfeff3fd02d7e6770041efaeaa2d7e9ecd602e820f926eb6921691c1f253d02.css as=style><link href=/scss/main.min.9dfeff3fd02d7e6770041efaeaa2d7e9ecd602e820f926eb6921691c1f253d02.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand-lg navbar-color td-navbar"><a class=navbar-brand href=/zh-cn/><span class=navbar-logo><svg id="selenium_logo" data-name="Selenium Logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 139.38 34"><defs><style>.cls-selenium_logo{fill:#fff}</style></defs><title>Selenium</title><path class="cls-selenium_logo" d="M46.2 26.37a18.85 18.85.0 01-2.57-.2 25 25 0 01-2.74-.53v-1.39a25.31 25.31.0 002.71.53 18 18 0 002.5.2 5.51 5.51.0 003.29-.84 2.79 2.79.0 001.14-2.39 2.85 2.85.0 00-1.24-2.49A6 6 0 0048 18.55q-.78-.29-1.67-.55A15.93 15.93.0 0144 17.13a5.92 5.92.0 01-1.58-1.05 3.6 3.6.0 01-.9-1.34A5 5 0 0141.23 13a4.46 4.46.0 01.41-1.93 4.31 4.31.0 011.17-1.5 5.26 5.26.0 011.82-1A8 8 0 0147 8.28a20.51 20.51.0 014.41.57v1.42a20 20 0 00-2.23-.44 15.2 15.2.0 00-2-.15 4.86 4.86.0 00-3.08.9A2.9 2.9.0 0042.88 13a3.25 3.25.0 00.21 1.21 2.61 2.61.0 00.7 1 4.83 4.83.0 001.27.79 14.31 14.31.0 002 .68q1.11.33 2.06.71a6.21 6.21.0 011.65.94 4.09 4.09.0 011.1 1.38 4.54 4.54.0 01.4 2 4.15 4.15.0 01-1.56 3.48A7.16 7.16.0 0146.2 26.37z"/><path class="cls-selenium_logo" d="M60.62 26.32a5.46 5.46.0 01-4.28-1.62A6.9 6.9.0 0154.88 20a7.8 7.8.0 011.43-5 5 5 0 014.14-1.75 4.24 4.24.0 013.47 1.43A6.48 6.48.0 0165.1 18.8q0 .54.0.92a3.22 3.22.0 01-.09.64H56.44a5.39 5.39.0 001.17 3.5A4.18 4.18.0 0060.8 25a10.52 10.52.0 001.82-.17 11.77 11.77.0 001.93-.52l.12 1.27a10.68 10.68.0 01-2 .55A11.47 11.47.0 0160.62 26.32zM60.4 14.43q-3.68.0-3.94 4.74h7.15a6.49 6.49.0 00-.78-3.63A2.76 2.76.0 0060.4 14.43z"/><path class="cls-selenium_logo" d="M68.64 7h1.58V26.11H68.64z"/><path class="cls-selenium_logo" d="M79.56 26.32a5.46 5.46.0 01-4.28-1.62A6.9 6.9.0 0173.83 20a7.8 7.8.0 011.43-5 5 5 0 014.14-1.75 4.24 4.24.0 013.47 1.43A6.48 6.48.0 0184 18.8q0 .54.0.92a3.22 3.22.0 01-.09.64H75.38a5.4 5.4.0 001.17 3.5A4.18 4.18.0 0079.75 25a10.52 10.52.0 001.82-.17 11.8 11.8.0 001.93-.52l.12 1.27a10.68 10.68.0 01-2 .55A11.47 11.47.0 0179.56 26.32zm-.21-11.89q-3.68.0-3.94 4.74h7.15a6.49 6.49.0 00-.78-3.63A2.76 2.76.0 0079.35 14.43z"/><path class="cls-selenium_logo" d="M87.51 13.37h1.32l.12 1.49h.12q.94-.45 1.72-.78t1.43-.54a8.42 8.42.0 011.2-.31 6.54 6.54.0 011.1-.09A3.3 3.3.0 0197 14a3.63 3.63.0 01.83 2.63v9.51H96.24v-9a3 3 0 00-.55-2 2.18 2.18.0 00-1.69-.6 7.25 7.25.0 00-2.24.41 20.1 20.1.0 00-2.67 1.12v10H87.51z"/><path class="cls-selenium_logo" d="M102.75 10.52a.93.93.0 01-1.06-1 1.06 1.06.0 012.12.0.93.93.0 01-1.06 1zm-.8 2.85h1.58V26.11h-1.58z"/><path class="cls-selenium_logo" d="M110.81 26.34q-3.14.0-3.14-3.47v-9.5h1.58v9a3.16 3.16.0 00.48 2 1.92 1.92.0 001.59.6 6.83 6.83.0 002.48-.48q1.25-.48 2.59-1.14V13.37H118V26.11h-1.32l-.12-1.58h-.09l-1.73.81q-.74.34-1.38.57a7.9 7.9.0 01-1.23.33A7.34 7.34.0 01110.81 26.34z"/><path class="cls-selenium_logo" d="M122.18 13.37h1.3l.14 1.49h.09a19.53 19.53.0 012.58-1.31 5.51 5.51.0 012-.41 2.83 2.83.0 013 1.77h.12q.8-.5 1.45-.83a12.61 12.61.0 011.2-.54 6.17 6.17.0 011-.31 5.18 5.18.0 011-.09 3.3 3.3.0 012.45.84 3.63 3.63.0 01.83 2.63v9.51h-1.56v-9a2.9 2.9.0 00-.55-2 2.21 2.21.0 00-1.69-.59 5.14 5.14.0 00-1.78.38A14.45 14.45.0 00131.6 16v10.1H130v-9a2.9 2.9.0 00-.55-2 2.21 2.21.0 00-1.69-.59 5.24 5.24.0 00-1.86.4A14 14 0 00123.76 16V26.11h-1.58z"/><path class="cls-selenium_logo" d="M21.45 21.51a2.49 2.49.0 00-2.55 2.21.08.08.0 00.08.1h4.95a.08.08.0 00.08-.09 2.41 2.41.0 00-2.56-2.22z"/><path class="cls-selenium_logo" d="M32.06 4.91 21.56 16.7a.32.32.0 01-.47.0l-5.36-5.53a.32.32.0 010-.4L17.5 8.5a.32.32.0 01.52.0l3 3.32a.32.32.0 00.49.0L29.87.36A.23.23.0 0029.69.0H.25A.25.25.0 000 .25v33.5A.25.25.0 00.25 34h32a.25.25.0 00.25-.25V5.06A.23.23.0 0032.06 4.91zm-23 25.36a8.08 8.08.0 01-5.74-2 .31.31.0 010-.41l1.25-1.75A.31.31.0 015 26a6.15 6.15.0 004.2 1.64c1.64.0 2.44-.76 2.44-1.56.0-2.48-8.08-.78-8.08-6.06.0-2.33 2-4.27 5.32-4.27a7.88 7.88.0 015.25 1.76.31.31.0 010 .43L12.9 19.65a.31.31.0 01-.45.05 6.08 6.08.0 00-3.84-1.32c-1.28.0-2 .57-2 1.41.0 2.23 8.06.74 8.06 6C14.67 28.33 12.84 30.27 9.05 30.27zM26.68 25.4a.27.27.0 01-.28.28H19a.09.09.0 00-.08.1 2.81 2.81.0 003 2.32 4.62 4.62.0 002.56-.84.27.27.0 01.4.06l.9 1.31a.28.28.0 01-.06.37 6.67 6.67.0 01-4.1 1.28 5.28 5.28.0 01-5.57-5.48 5.31 5.31.0 015.4-5.46c3.11.0 5.22 2.33 5.22 5.74z"/></svg></span></a><button class=navbar-toggler type=button data-toggle=collapse data-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end" id=main_navbar><ul class="navbar-nav mr-4 mb-2 mb-lg-0 pl-4 pl-lg-2"><li class="nav-item mr-4 mb-2 mb-lg-0"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>About</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/zh-cn/about>About Selenium</a>
<a class=dropdown-item href=/zh-cn/project>Structure and Governance</a>
<a class=dropdown-item href=/zh-cn/events>Events</a>
<a class=dropdown-item href=/zh-cn/ecosystem>Ecosystem</a>
<a class=dropdown-item href=/zh-cn/history>History</a>
<a class=dropdown-item href=/zh-cn/getinvolved>Get Involved</a>
<a class=dropdown-item href=/zh-cn/sponsors>Sponsors</a></div></li></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/downloads><span>Downloads</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/documentation><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/projects><span>Projects</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/support><span>Support</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/zh-cn/blog><span>Blog</span></a></li><li class="nav-item dropdown d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>中文简体</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/documentation/grid/>English</a>
<a class=dropdown-item href=/es/documentation/grid/>Español</a>
<a class=dropdown-item href=/de/documentation/grid/>Deutsch</a>
<a class=dropdown-item href=/pt-br/documentation/grid/>Português (Brasileiro)</a>
<a class=dropdown-item href=/nl/documentation/grid/>Nederlands</a>
<a class=dropdown-item href=/fr/documentation/grid/>Français</a>
<a class=dropdown-item href=/ja/documentation/grid/>日本語</a>
<a class=dropdown-item href=/ko/documentation/grid/>한국어</a></div></li></ul><div class=navbar-nav><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/zh-cn/documentation/grid/>Return to the regular view of this page</a>.</p></div><h1 class=title>Grid</h1><div class=lead>要在多台计算机上并行运行测试吗? 那么, Grid正是为你准备的.</div><ul><li>1: <a href=#pg-513aea440f7a5dcdf2fd2cf091439f36>服务网格的组件</a></li><li>2: <a href=#pg-e4d0a1214d8f6a629e7384fac3d5e30e>配置自己的服务网格</a></li><li>3: <a href=#pg-205f46aaf95b789941fbfb3037361a44>配置组件</a></li><ul><li>3.1: <a href=#pg-3ce7ee4b29b4aa8de1776db740cf2434>配置帮助</a></li><li>3.2: <a href=#pg-2786434e316aa4608c870e967b14db83>CLI Options</a></li><li>3.3: <a href=#pg-ac4bcef9ce7714cb39ab579cdd145a35>Toml Options</a></li></ul><li>4: <a href=#pg-9586edf2b9ce7e57a4873d12c1cb49bf>高级功能</a></li><ul><li>4.1: <a href=#pg-58fa36fce0115e0cac81fa0157f35027>Observability</a></li><li>4.2: <a href=#pg-5accfc3d64bfa8a3f37b3a48872e2e2d>GraphQL查询支持</a></li><li>4.3: <a href=#pg-1e74293b60642ddab77bb57253bc8cce>Grid端点</a></li></ul><li>5: <a href=#pg-0dfead81648fd92f1f69064ff55127bf>什么时候应该使用服务网格</a></li></ul><div class=content><p>通过将客户端命令发送到远程浏览器的实例,
Selenium Grid 允许在远程计算机 (虚拟或真实) 上执行WebDriver脚本.
它旨在提供一种在多台计算机上并行运行测试的简便方法.</p><p>Selenium Grid允许我们在多台计算机上并行运行测试,
并集中管理不同的浏览器版本和浏览器配置
(而不是在每个独立的测试中).</p><p>Selenium Grid不是银弹.
它解决了一些常见的委派和分布式问题,
但是例如无法管理基础架构这样的问题,
可能不适合您的特定需求.</p><h2 id=目的和主要功能>目的和主要功能</h2><ul><li>为所有的测试提供统一的入口</li><li>管理和控制运行着浏览器的节点/环境</li><li>扩展</li><li>并行测试</li><li>跨平台(操作系统)测试</li><li>负载测试</li></ul><div class="alert alert-primary" role=alert><h4 class=alert-heading>Selenium Grid 4</h4><p>Grid 4有一种实现可以利用许多新技术来促进扩展,
同时仍然允许本地执行.</p><p>Selenium Grid 4 是全新的实现,
并且不共享之前版本的代码库.</p><p>关于Grid 4组件的所有详细信息,
了解其工作原理以及如何设置自己的组件,
请浏览以下章节.</p></div></div></div><div class=td-content style=page-break-before:always><h1 id=pg-513aea440f7a5dcdf2fd2cf091439f36>1 - 服务网格的组件</h1><div class=lead>Check the different Grid components to understand how to use them.</div><div class="card mb-4"><div class=card-header><strong>Grid Components</strong></div><div class=card-body><p class=card-text><img src=/images/documentation/grid/components.png alt="Selenium Grid 4 Components" title="Selenium Grid 4 Components"></p></div><div class=card-footer>Grid components shown in the fully distributed mode</div></div><h2 id=路由>路由</h2><p>路由负责将请求转发到正确的组件.</p><p>它是Grid的入口点, 所有外部请求都将由其接收.
路由的行为因请求而异.
当请求一个新的会话时, 路由将把它添加到新的会话队列中.
分发器定期检查是否有空闲槽.
若有, 则从新会话队列中删除第一个匹配请求.
如果请求属于存量会话,
这个路由将会话id发送到会话表,
会话表将返回正在运行会话的节点.
在此之后, 路由将
将请求转发到节点.</p><p>为了更好地发挥效力,
路由通过将请求发送到组件的方式,
来平衡Grid的负载,
从而使处理过程中不会有任何的过载组件.</p><h2 id=distributor>Distributor</h2><p>分发器知道所有节点及其功能.
它的主要作用是接收新的会话请求
并找到可以在其中创建会话的适当节点.
创建会话后, 分发器在会话集合中存储会话ID与正在执行会话的节点之间的关系.</p><h2 id=node>Node</h2><p>一个节点可以在网格中出现多次.
每个节点负责管理其运行机器的可用浏览器的插槽.</p><p>节点通过事件总线将其自身注册到分发服务器,
并且将其配置作为注册消息的组成部分一起发送.</p><p>By default, the Node auto-registers all browser drivers available on the path of
the machine where it runs. It also creates one slot per available CPU for Chromium
based browsers and Firefox. For Safari and Internet Explorer, only one slot is created.
Through a specific configuration, it can run sessions in Docker containers or relay commands.
You can see more configuration details in the next <a href=/zh-cn/documentation/grid/setting_up_your_own_grid/>section</a>.</p><p>节点仅执行接收到的命令,
它不进行评估、做出判断或控制任何事情.
运行节点的计算机不需要与其他组件具有相同的操作系统.
例如, Windows节点可以具有将Internet Explorer作为浏览器选项的功能,
而在Linux或Mac上则无法实现.</p><h2 id=会话表>会话表</h2><p>会话表是一种数据存储的方式,
用于保存会话id和会话运行的节点的信息.
它作为路由支持,
在向节点转发请求的过程中起作用.
路由将通过会话表获取与会话id关联的节点.</p><h2 id=新会话队列>新会话队列</h2><p>新会话队列以先进先出的顺序保存所有新会话请求.
其具有用于设置请求超时和请求重试间隔的可配置参数.</p><p>路由将新会话请求添加到新会话队列并等待响应.
新会话队列定期检查队列中的任何请求是否已超时,
若有，则请求将被拒绝并立即删除.</p><p>分发器定期检查是否有可用槽.
若有, 分发器将为第一个匹配的请求索取新会话队列.
然后分发器会尝试创建新的会话.</p><p>一旦请求的功能与任何空闲节点槽匹配,
分发器将尝试获取可用槽.
如果没有空闲槽,
分发器会要求队列将请求添加到队列前面.
如果请求在重试或添加到队列头时超时,
则该请求将被拒绝.</p><p>成功创建会话后,
分发器将会话信息发送到新会话队列.
新会话队列将响应发送回客户端.</p><h2 id=事件总线>事件总线</h2><p>事件总线充当节点、分发服务器、新的会话队列器和会话表之间的通信路径.
网格通过消息进行大部分内部通信, 避免了昂贵的HTTP调用.
当以完全分布式模式启动网格时, 事件总线是应该启动的第一个组件.</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Running your own Grid</h4>Looking forward to using all these components and run your own Grid?
Head to the <a href=/zh-cn/documentation/grid/setting_up_your_own_grid/>&ldquo;Setting up your own&rdquo;</a>
section to understand how to put all these pieces together.</div></div><div class=td-content style=page-break-before:always><h1 id=pg-e4d0a1214d8f6a629e7384fac3d5e30e>2 - 配置自己的服务网格</h1><div class=lead>Instructions, step by step, showing how to run a simple Selenium Grid.</div><div class="pageinfo pageinfo-warning"><p class=lead><i class="fas fa-language display-4"></i>
Page being translated from
English to Chinese. Do you speak Chinese? Help us to translate
it by sending us pull requests!</p></div><h2 id=grid-roles>Grid roles</h2><p>Several <a href=/zh-cn/documentation/grid/components_of_a_grid/>components</a> compose a Selenium Grid. Depending
on your needs, you can start each one of them on its own, or a few at the same time by using a
Grid role.</p><h3 id=standalone>Standalone</h3><p>Standalone is the union of all components, and to the user&rsquo;s eyes, they are executed as one.
A fully functional Grid of one is available after starting it in the Standalone mode.</p><p>Standalone is also the easiest mode to spin up a Selenium Grid. By default, the server
will be listening on <code>http://localhost:4444</code>, and that&rsquo;s the URL you should point your
<code>RemoteWebDriver</code> tests. The server will detect the available drivers that it can use
from the System <code>PATH</code>.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar standalone
</code></pre></div><h3 id=hub-and-nodes>Hub and Node(s)</h3><p>It enables the classic Hub & Node(s) setup. These roles are suitable for small
and middle-sized Grids.</p><h4 id=hub>Hub</h4><p>A Hub is the union of the following components:</p><ul><li>Router</li><li>Distributor</li><li>Session Map</li><li>New Session Queue</li><li>Event Bus</li></ul><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar hub
</code></pre></div><p>By default, the server will be listening on <code>http://localhost:4444</code>, and that&rsquo;s the URL
you should point your <code>RemoteWebDriver</code> tests.</p><h4 id=nodes>Node(s)</h4><p>One or more Nodes can be started in this setup, and the server will detect the available
drivers that it can use from the System <code>PATH</code>.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar node
</code></pre></div><h3 id=distributed>Distributed</h3><p>On Distributed mode, each component needs to be started on its own. This setup is more suitable
for large Grids.</p><div class="alert alert-primary" role=alert>The startup order of the components is not important, however, we recommend following these
steps when starting a distributed Grid.</div><ol><li>Event Bus: serves as a communication path to other Grid components in subsequent steps.</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar  event-bus
</code></pre></div><ol start=2><li>Session Map: responsible for mapping session IDs to the Node where the session is running.</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar sessions
</code></pre></div><ol start=3><li>New Session Queue: adds the new session request to a queue, then the distributor processes it.</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar sessionqueue
</code></pre></div><ol start=4><li>Distributor: Nodes register to it, and assigns a Node for a session request.</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar distributor --sessions http://localhost:5556 --sessionqueue http://localhost:5559 --bind-bus <span style=color:#204a87>false</span>
</code></pre></div><ol start=5><li>Router: the Grid entrypoint, in charge of redirecting requests to the right component.</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar router --sessions http://localhost:5556 --distributor http://localhost:5553 --sessionqueue http://localhost:5559
</code></pre></div><ol start=6><li>Node(s)</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar node 
</code></pre></div><h2 id=querying-selenium-grid>Querying Selenium Grid</h2><p>After starting a Grid, there are mainly two ways of querying its status, through the Grid
UI or via an API call.</p><p>The Grid UI can be reached by opening your preferred browser and heading to
<a href=http://localhost:4444>http://localhost:4444</a>.</p><p>API calls can be done through the <a href=http://localhost:4444/status>http://localhost:4444/status</a>
endpoint or using GraphQL:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{ &#34;query&#34;: &#34;{grid{uri}}&#34; }&#39;</span> -s http://localhost:4444/graphql <span style=color:#000;font-weight:700>|</span> jq .
</code></pre></div><div class="pageinfo pageinfo-primary"><p>For simplicity, all command examples shown in this page assume that components are running
locally. More detailed examples and usages can be found in the
<a href=/zh-cn/documentation/grid/configuring_components/>Configuring Components</a> section.</p></div><h2 id=warning>Warning</h2><p>Selenium Grid must be protected from external access using appropriate
firewall permissions.</p><p>Failure to protect your Grid could result in one or more of the following occurring:</p><ul><li>You provide open access to your Grid infrastructure</li><li>You allow third parties to access internal web applications and files</li><li>You allow third parties to run custom binaries</li></ul><p>See this blog post on <a href=//labs.detectify.com>Detectify</a>, which gives a good
overview of how a publicly exposed Grid could be misused:
<a href=//labs.detectify.com/2017/10/06/guest-blog-dont-leave-your-grid-wide-open/>Don&rsquo;t Leave your Grid Wide Open</a></p><h2 id=提醒>提醒</h2><p>Selenium服务网格需要使用合适的防火墙许可来隔离外部访问。</p><p>如果不能有效的保护你的服务网格，可能会导致以下问题：</p><ul><li>提供了一个开发的接口来访问服务网格的基础设施</li><li>你将会允许第三方来访问内部web服务和文件</li><li>你将会允许第三方来执行定制的二进制文件</li></ul><p>请参考这篇文章<a href=//labs.detectify.com>Detectify</a>, 这里给了一个很好的概要，
关于暴露一个服务网格后会如何被滥用：<a href=//labs.detectify.com/2017/10/06/guest-blog-dont-leave-your-grid-wide-open/>Don&rsquo;t Leave your Grid Wide Open</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-205f46aaf95b789941fbfb3037361a44>3 - 配置组件</h1><div class=lead>Here you can see how each Grid component can be configured individually based on common configuration values and component-specific configuration values.</div><div class="pageinfo pageinfo-warning"><p class=lead><i class="fas fa-language display-4"></i>
Page being translated from
English to Chinese. Do you speak Chinese? Help us to translate
it by sending us pull requests!</p></div></div><div class=td-content><h1 id=pg-3ce7ee4b29b4aa8de1776db740cf2434>3.1 - 配置帮助</h1><div class=lead>Get information about all the available options to configure Grid.</div><div class="pageinfo pageinfo-primary"><p>Help命令显示基于当前代码实现的信息.
因此, 如果文档没有更新, 它将提供准确的信息.
这是了解任何新版本Grid4配置的最便捷方法.</p></div><h2 id=信息命令>信息命令</h2><p>Info命令提供以下主题的详细文档:</p><ul><li>配置Selenium</li><li>安全</li><li>会话表配置</li><li>追踪</li></ul><h3 id=配置帮助>配置帮助</h3><p>通过运行以下命令快速获取配置帮助:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar info config
</code></pre></div><h3 id=安全>安全</h3><p>获取构建网格服务器的详细信息,
用于安全通信和节点注册.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar info security
</code></pre></div><h3 id=会话表配置>会话表配置</h3><p>默认情况下,
网格使用本地会话表来存储会话信息.
网格支持额外的存储选项,
比如Redis和JDBC-SQL支持的数据库.
要设置不同的会话存储,
请使用以下命令获取设置步骤:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar info sessionmap
</code></pre></div><h3 id=基于opentelemetry和jaeger的追踪配置>基于OpenTelemetry和Jaeger的追踪配置</h3><p>默认情况下, 追踪是启用的.
要通过Jaeger导出追踪并将其可视化,
请使用以下命令进行说明:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar info tracing
</code></pre></div><h2 id=列出selenium网格的命令>列出Selenium网格的命令</h2><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar --config-help
</code></pre></div><p>上述命令将显示所有可用的命令及其描述.</p><h2 id=组件帮助命令>组件帮助命令</h2><p>在Selenium后面键入&ndash;help的配置选项,
以获取特定组件的配置信息.</p><h3 id=standalone>Standalone</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar standalone --help
</code></pre></div><h3 id=hub>Hub</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar hub --help
</code></pre></div><h3 id=sessions>Sessions</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar sessions --help
</code></pre></div><h3 id=队列器>队列器</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar sessionqueue --help
</code></pre></div><h3 id=distributor>Distributor</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar distributor --help
</code></pre></div><h3 id=router>Router</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar router --help
</code></pre></div><h3 id=node>Node</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-&lt;version&gt;.jar node --help
</code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-2786434e316aa4608c870e967b14db83>3.2 - CLI Options</h1><div class=lead>All Grid components configuration CLI options in detail.</div><div class="pageinfo pageinfo-warning"><p class=lead><i class="fas fa-language display-4"></i>
Page being translated from
English to Chinese. Do you speak Chinese? Help us to translate
it by sending us pull requests!</p></div><p>Different sections are available to configure a Grid. Each section has options can be configured
through command line arguments.</p><p>A complete description of the component to section mapping can be seen below.</p><div class="pageinfo pageinfo-primary"><p>Note that this documentation could be outdated if an option was modified or added
but has not been documented yet. In case you bump into this situation, please check
the <a href=/zh-cn/documentation/grid/configuring_components/config_help/>&ldquo;Config help&rdquo;</a> section and feel free to send us a
pull request updating this page.</p></div><h2 id=sections>Sections</h2><table class="table table-bordered text-md-center d-md-table-cell"><thead><tr><th></th><th>Standalone</th><th>Hub</th><th>Node</th><th>Distributor</th><th>Router</th><th>Sessions</th><th>SessionQueue</th></tr></thead><tbody><tr><th><a href=#distributor>Distributor</a></th><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td></td><td></td></tr><tr><th><a href=#docker>Docker</a></th><td><i class="fas fa-check"></i></td><td></td><td><i class="fas fa-check"></i></td><td></td><td></td><td></td><td></td></tr><tr><th><a href=#events>Events</a></th><td></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td></tr><tr><th><a href=#logging>Logging</a></th><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td></tr><tr><th><a href=#network>Network</a></th><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td></td><td></td><td><i class="fas fa-check"></i></td><td></td><td></td></tr><tr><th><a href=#node>Node</a></th><td><i class="fas fa-check"></i></td><td></td><td><i class="fas fa-check"></i></td><td></td><td></td><td></td><td></td></tr><tr><th><a href=#router>Router</a></th><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td></td><td></td><td><i class="fas fa-check"></i></td><td></td><td></td></tr><tr><th><a href=#relay>Relay</a></th><td><i class="fas fa-check"></i></td><td></td><td><i class="fas fa-check"></i></td><td></td><td></td><td></td><td></td></tr><tr><th><a href=#server>Server</a></th><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td></tr><tr><th><a href=#sessionqueue>SessionQueue</a></th><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td></td><td><i class="fas fa-check"></i></td></tr><tr><th><a href=#sessions>Sessions</a></th><td></td><td></td><td></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td><i class="fas fa-check"></i></td><td></td></tr></tbody></table><h3 id=distributor>Distributor</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--grid-model</code></td><td>string</td><td><code>org.openqa.selenium.grid.distributor.GridModel</code></td><td>Full classname of non-default grid model. This is used to store the states of all the registered Nodes.</td></tr><tr><td><code>--healthcheck-interval</code></td><td>int</td><td><code>120</code></td><td>How often, in seconds, will the health check run for all Nodes. This ensures the server can ping all the Nodes successfully.</td></tr><tr><td><code>--distributor</code></td><td>uri</td><td><code>http://localhost:5553</code></td><td>Url of the distributor.</td></tr><tr><td><code>--distributor-host</code></td><td>string</td><td><code>localhost</code></td><td>Host on which the distributor is listening.</td></tr><tr><td><code>--distributor-implementation</code></td><td>string</td><td><code>org.openqa.selenium.grid.distributor.local.LocalDistributor</code></td><td>Full class name of non-default distributor implementation</td></tr><tr><td><code>--distributor-port</code></td><td>int</td><td><code>5553</code></td><td>Port on which the distributor is listening.</td></tr><tr><td><code>--reject-unsupported-caps</code></td><td>boolean</td><td><code>false</code></td><td>Allow the Distributor to reject a request immediately if the Grid does not support the requested capability. Rejecting requests immediately is suitable for a Grid setup that does not spin up Nodes on demand.</td></tr><tr><td><code>--slot-matcher</code></td><td>string</td><td><code>org.openqa.selenium.grid.data.DefaultSlotMatcher</code></td><td>Full class name of non-default slot matcher to use. This is used to determine whether a Node can support a particular session.</td></tr><tr><td><code>--slot-selector</code></td><td>string</td><td><code>org.openqa.selenium.grid.distributor.selector.DefaultSlotSelector</code></td><td>Full class name of non-default slot selector. This is used to select a slot in a Node once the Node has been matched.</td></tr></tbody></table><h3 id=docker>Docker</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--docker-assets-path</code></td><td>string</td><td><code>/opt/selenium/assets</code></td><td>Absolute path where assets will be stored</td></tr><tr><td><code>--docker-</code></td><td>string[]</td><td><code>selenium/standalone-firefox:latest '{"browserName": "firefox"}'</code></td><td>Docker configs which map image name to stereotype capabilities (example `-D selenium/standalone-firefox:latest &lsquo;{&ldquo;browserName&rdquo;: &ldquo;firefox&rdquo;}')</td></tr><tr><td><code>--docker-host</code></td><td>string</td><td><code>localhost</code></td><td>Host name where the Docker daemon is running</td></tr><tr><td><code>--docker-port</code></td><td>int</td><td><code>2375</code></td><td>Port where the Docker daemon is running</td></tr><tr><td><code>--docker-url</code></td><td>string</td><td><code>http://localhost:2375</code></td><td>URL for connecting to the Docker daemon</td></tr><tr><td><code>--docker-video-image</code></td><td>string</td><td><code>selenium/video:latest</code></td><td>Docker image to be used when video recording is enabled</td></tr></tbody></table><h3 id=events>Events</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--bind-bus</code></td><td>boolean</td><td><code>false</code></td><td>Whether the connection string should be bound or connected.<br>When true, the component will be bound to the Event Bus (as in the Event Bus will also be started by the component, typically by the Distributor and the Hub).<br>When false, the component will connect to the Event Bus.</td></tr><tr><td><code>--events-implementation</code></td><td>string</td><td><code>org.openqa.selenium.events.zeromq.ZeroMqEventBus</code></td><td>Full class name of non-default event bus implementation</td></tr><tr><td><code>--publish-events</code></td><td>string</td><td><code>tcp://*:4442</code></td><td>Connection string for publishing events to the event bus</td></tr><tr><td><code>--subscribe-events</code></td><td>string</td><td><code>tcp://*:4443</code></td><td>Connection string for subscribing to events from the event bus</td></tr></tbody></table><h3 id=logging>Logging</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--http-logs</code></td><td>boolean</td><td><code>false</code></td><td>Enable http logging. Tracing should be enabled to log http logs.</td></tr><tr><td><code>--log-encoding</code></td><td>string</td><td><code>UTF-8</code></td><td>Log encoding</td></tr><tr><td><code>--log</code></td><td>string</td><td>Windows path example :<br><code>'\path\to\file\gridlog.log'</code><br>or<br><code>'C:\path\path\to\file\gridlog.log'</code><br><br>Linux/Unix/MacOS path example :<br><code>'/path/to/file/gridlog.log'</code></td><td>File to write out logs. Ensure the file path is compatible with the operating system&rsquo;s file path.</td></tr><tr><td><code>--log-level</code></td><td>string</td><td><code>“INFO”</code></td><td>Log level. Default logging level is INFO. Log levels are described here <a href=https://docs.oracle.com/javase/7/docs/api/java/util/logging/Level.html>https://docs.oracle.com/javase/7/docs/api/java/util/logging/Level.html</a></td></tr><tr><td><code>--plain-logs</code></td><td>boolean</td><td><code>true</code></td><td>Use plain log lines</td></tr><tr><td><code>--structured-logs</code></td><td>boolean</td><td><code>false</code></td><td>Use structured logs</td></tr><tr><td><code>--tracing</code></td><td>boolean</td><td><code>true</code></td><td>Enable trace collection</td></tr></tbody></table><h3 id=network>Network</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--relax-checks</code></td><td>boolean</td><td><code>false</code></td><td>Relax checks on origin header and content type of incoming requests, in contravention of strict W3C spec compliance.</td></tr></tbody></table><h3 id=node>Node</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th><th></th></tr></thead><tbody><tr><td><code>--detect-drivers</code></td><td>boolean</td><td><code>true</code></td><td>Autodetect which drivers are available on the current system, and add them to the Node.</td><td></td></tr><tr><td><code>--driver-configuration</code></td><td>string[]</td><td><code>display-name="Firefox Nightly" max-sessions=2 webdriver-path="/usr/local/bin/geckodriver" stereotype='{"browserName": "firefox", "browserVersion": "86", "moz:firefoxOptions": {"binary":"/Applications/Firefox Nightly.app/Contents/MacOS/firefox-bin"}}'</code></td><td>List of configured drivers a Node supports. It is recommended to provide this type of configuration through a toml config file to improve readability</td><td></td></tr><tr><td><code>--driver-factory</code></td><td>string[]</td><td><code>org.openqa.selenium.example.LynxDriverFactory '{"browserName": "lynx"}'</code></td><td>Mapping of fully qualified class name to a browser configuration that this matches against.</td><td></td></tr><tr><td><code>--driver-implementation</code></td><td>string[]</td><td><code>"firefox"</code></td><td>Drivers that should be checked. If specified, will skip autoconfiguration.</td><td></td></tr><tr><td><code>--grid-url</code></td><td>string</td><td><code>https://grid.example.com</code></td><td>Public URL of the Grid as a whole (typically the address of the Hub or the Router)</td><td></td></tr><tr><td><code>--heartbeat-period</code></td><td>int</td><td><code>60</code></td><td>How often, in seconds, will the Node send heartbeat events to the Distributor to inform it that the Node is up.</td><td></td></tr><tr><td><code>--max-sessions</code></td><td>int</td><td><code>8</code></td><td>Maximum number of concurrent sessions. Default value is the number of available processors.</td><td></td></tr><tr><td><code>--override-max-sessions</code></td><td>boolean</td><td><code>false</code></td><td>The # of available processos is the recommended max sessions value (1 browser session per processor). Setting this flag to true allows the recommended max value to be overwritten. Session stability and reliability might suffer as the host could run out of resources.</td><td></td></tr><tr><td><code>--register-cycle</code></td><td>int</td><td><code>10</code></td><td>How often, in seconds, the Node will try to register itself for the first time to the Distributor.</td><td></td></tr><tr><td><code>--register-period</code></td><td>int</td><td><code>120</code></td><td>How long, in seconds, will the Node try to register to the Distributor for the first time. After this period is completed, the Node will not attempt to register again.</td><td></td></tr><tr><td><code>--session-timeout</code></td><td>int</td><td><code>300</code></td><td>Let X be the session-timeout in seconds. The Node will automatically kill a session that has not had any activity in the last X seconds. This will release the slot for other tests.</td><td></td></tr><tr><td><code>--vnc-env-var</code></td><td>string</td><td><code>START_XVFB</code></td><td>Environment variable to check in order to determine if a vnc stream is available or not.</td><td></td></tr></tbody></table><h3 id=relay>Relay</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--service-url</code></td><td>string</td><td><code>http://localhost:67853</code></td><td>URL for connecting to the service</td></tr><tr><td><code>--service-host</code></td><td>string</td><td><code>localhost</code></td><td>Host name where the service is running</td></tr><tr><td><code>--service-port</code></td><td>int</td><td><code>67853</code></td><td>Port where the service is running</td></tr><tr><td><code>--service-status-endpoint</code></td><td>string</td><td><code>/status</code></td><td>Optional, endpoint to query the service status, an HTTP 200 response is expected</td></tr></tbody></table><h3 id=router>Router</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--password</code></td><td>string</td><td><code>myStrongPassword</code></td><td>Password clients must use to connect to the server. Both this and the username need to be set in order to be used.</td></tr><tr><td><code>--username</code></td><td>string</td><td><code>admin</code></td><td>User name clients must use to connect to the server. Both this and the password need to be set in order to be used.</td></tr></tbody></table><h3 id=server>Server</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--allow-cors</code></td><td>boolean</td><td><code>true</code></td><td>Whether the Selenium server should allow web browser connections from any host</td></tr><tr><td><code>--host</code></td><td>string</td><td><code>localhost</code></td><td>Server IP or hostname: usually determined automatically.</td></tr><tr><td><code>--https-certificate</code></td><td>path</td><td><code>/path/to/cert.pem</code></td><td>Server certificate for https. Get more detailed information by running &ldquo;java -jar selenium-server.jar info security&rdquo;</td></tr><tr><td><code>--https-private-key</code></td><td>path</td><td><code>/path/to/key.pkcs8</code></td><td>Private key for https. Get more detailed information by running &ldquo;java -jar selenium-server.jar info security&rdquo;</td></tr><tr><td><code>--max-threads</code></td><td>int</td><td><code>24</code></td><td>Maximum number of listener threads. Default value is: (available processors) * 3.</td></tr><tr><td><code>--port</code></td><td>int</td><td><code>4444</code></td><td>Port to listen on. There is no default as this parameter is used by different components, for example, Router/Hub/Standalone will use 4444 and Node will use 5555.</td></tr></tbody></table><h3 id=sessionqueue>SessionQueue</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--sessionqueue</code></td><td>uri</td><td><code>http://localhost:1237</code></td><td>Address of the session queue server.</td></tr><tr><td><code>-sessionqueue-host</code></td><td>string</td><td><code>localhost</code></td><td>Host on which the session queue server is listening.</td></tr><tr><td><code>--sessionqueue-port</code></td><td>int</td><td><code>1234</code></td><td>Port on which the session queue server is listening.</td></tr><tr><td><code>--session-request-timeout</code></td><td>int</td><td><code>300</code></td><td>Timeout in seconds. A new incoming session request is added to the queue. Requests sitting in the queue for longer than the configured time will timeout.</td></tr><tr><td><code>--session-retry-interval</code></td><td>int</td><td><code>5</code></td><td>Retry interval in seconds. If all slots are busy, new session request will be retried after the given interval.</td></tr></tbody></table><h3 id=sessions>Sessions</h3><table><thead><tr><th>Option</th><th>Type</th><th>Value/Example</th><th>Description</th></tr></thead><tbody><tr><td><code>--sessions</code></td><td>uri</td><td><code>http://localhost:1234</code></td><td>Address of the session map server.</td></tr><tr><td><code>--sessions-host</code></td><td>string</td><td><code>localhost</code></td><td>Host on which the session map server is listening.</td></tr><tr><td><code>--sessions-port</code></td><td>int</td><td><code>1234</code></td><td>Port on which the session map server is listening.</td></tr></tbody></table><h2 id=configuration-examples>Configuration examples</h2><p>All the options mentioned above can be used when starting the Grid components. They are a good
way of exploring the Grid options, and trying out values to find a suitable configuration.</p><div class="pageinfo pageinfo-primary"><p>We recommend the use of <a href=/zh-cn/documentation/grid/configuring_components/toml_options/>Toml files</a> to configure a Grid.
Configuration files improve readability, and you can also check them in source control.</p><p>When needed, you can combine a Toml file configuration with CLI arguments.</p></div><h3 id=command-line-flags>Command-line flags</h3><p>To pass config options as command-line flags, identify the valid options for the component
and follow the template below.</p><pre><code>java -jar selenium-server-&lt;version&gt;.jar &lt;component&gt; --&lt;option&gt; value
</code></pre><h4 id=standalone-setting-max-sessions-and-main-port>Standalone, setting max sessions and main port</h4><pre><code>java -jar selenium-server-&lt;version&gt;.jar standalone --max-sessions 4 --port 4444
</code></pre><h4 id=hub-setting-a-new-session-request-timeout-a-main-port-and-disabling-tracing>Hub, setting a new session request timeout, a main port, and disabling tracing</h4><pre><code>java -jar selenium-server-&lt;version&gt;.jar hub --session-request-timeout 500 --port 3333 --tracing false
</code></pre><h4 id=node-with-4-max-sessions-with-debugfine-log-7777-as-port-and-only-with-firefox-and-edge>Node, with 4 max sessions, with debug(fine) log, 7777 as port, and only with Firefox and Edge</h4><pre><code>java -jar selenium-server-&lt;version&gt;.jar node --max-sessions 4 --log-level &quot;fine&quot; --port 7777 --driver-implementation &quot;firefox&quot; --driver-implementation &quot;edge&quot;
</code></pre><h4 id=distributor-setting-session-map-server-url-session-queue-server-url-and-disabling-bus>Distributor, setting Session Map server url, Session Queue server url, and disabling bus</h4><pre><code>java -jar selenium-server-&lt;version&gt;.jar distributor --sessions http://localhost:5556 --sessionqueue http://localhost:5559 --bind-bus false
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-ac4bcef9ce7714cb39ab579cdd145a35>3.3 - Toml Options</h1><div class=lead>Grid configuration examples using Toml files.</div><div class="pageinfo pageinfo-warning"><p class=lead><i class="fas fa-language display-4"></i>
Page being translated from
English to Chinese. Do you speak Chinese? Help us to translate
it by sending us pull requests!</p></div><p>All the options shown in <a href=/zh-cn/documentation/grid/configuring_components/cli_options/>CLI options</a> can be configured through
a <a href=https://github.com/toml-lang/toml>TOML</a> file. This page shows configuration examples for the
different Grid components.</p><div class="pageinfo pageinfo-primary"><p>Note that this documentation could be outdated if an option was modified or added
but has not been documented yet. In case you bump into this situation, please check
the <a href=/zh-cn/documentation/grid/configuring_components/config_help/>&ldquo;Config help&rdquo;</a> section and feel free to send us a
pull request updating this page.</p></div><h2 id=overview>Overview</h2><p>Selenium Grid uses <a href=https://github.com/toml-lang/toml>TOML</a> format for config files.
The config file consists of sections and each section has options and its respective value(s).</p><p>Refer to the <a href=https://toml.io/en/>TOML documentation</a> for detailed usage guidance. In case of
parsing errors, validate the config using <a href=https://www.toml-lint.com/>TOML linter</a>.</p><p>The general configuration structure has the following pattern:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=color:#000;font-weight:700>[</span><span style=color:#000>section1</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>option1</span><span style=color:#000;font-weight:700>=</span><span style=color:#4e9a06>&#34;value&#34;</span>

<span style=color:#000;font-weight:700>[</span><span style=color:#000>section2</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>option2</span><span style=color:#000;font-weight:700>=[</span><span style=color:#4e9a06>&#34;value1&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#34;value2&#34;</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>option3</span><span style=color:#000;font-weight:700>=</span><span style=color:#204a87;font-weight:700>true</span>
</code></pre></div><p>Below are some examples of Grid components configured with a Toml file, the component can be
started in the following way:</p><pre><code>java -jar selenium-server-&lt;version&gt;.jar &lt;component&gt; --config /path/to/file/&lt;file-name&gt;.toml
</code></pre><h3 id=standalone>Standalone</h3><p>A Standalone server, running on port 4449, and a new session request timeout of 500 seconds.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=color:#000;font-weight:700>[</span><span style=color:#000>server</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>port</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>4449</span>

<span style=color:#000;font-weight:700>[</span><span style=color:#000>sessionqueue</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>session</span><span style=color:#a40000>-</span><span style=color:#000>request</span><span style=color:#a40000>-</span><span style=color:#000>timeout</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>500</span>
</code></pre></div><h3 id=specific-browsers-and-a-limit-of-max-sessions>Specific browsers and a limit of max sessions</h3><p>A Standalone server or a Node which only has Firefox and Chrome enabled by default.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=color:#000;font-weight:700>[</span><span style=color:#000>node</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>drivers</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;chrome&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;firefox&#34;</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>max</span><span style=color:#a40000>-</span><span style=color:#000>sessions</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>3</span>
</code></pre></div><h3 id=configuring-and-customising-drivers>Configuring and customising drivers</h3><p>Standalone or Node server with customised drivers, which allows things like having Firefox Beta
or Nightly, and having different browser versions.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=color:#000;font-weight:700>[</span><span style=color:#000>node</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>detect</span><span style=color:#a40000>-</span><span style=color:#000>drivers</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span>
<span style=color:#000;font-weight:700>[[</span><span style=color:#000>node</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>driver</span><span style=color:#a40000>-</span><span style=color:#000>configuration</span><span style=color:#000;font-weight:700>]]</span>
<span style=color:#000>max</span><span style=color:#a40000>-</span><span style=color:#000>sessions</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>100</span>
<span style=color:#000>display</span><span style=color:#a40000>-</span><span style=color:#000>name</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Firefox Nightly&#34;</span>
<span style=color:#000>stereotype</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;{\&#34;browserName\&#34;: \&#34;firefox\&#34;, \&#34;browserVersion\&#34;: \&#34;93\&#34;, \&#34;platformName\&#34;: \&#34;MAC\&#34;, \&#34;moz:firefoxOptions\&#34;: {\&#34;binary\&#34;: \&#34;/Applications/Firefox Nightly.app/Contents/MacOS/firefox-bin\&#34;}}&#34;</span>
<span style=color:#000;font-weight:700>[[</span><span style=color:#000>node</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>driver</span><span style=color:#a40000>-</span><span style=color:#000>configuration</span><span style=color:#000;font-weight:700>]]</span>
<span style=color:#000>display</span><span style=color:#a40000>-</span><span style=color:#000>name</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Chrome Beta&#34;</span>
<span style=color:#000>stereotype</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;{\&#34;browserName\&#34;: \&#34;chrome\&#34;, \&#34;browserVersion\&#34;: \&#34;94\&#34;, \&#34;platformName\&#34;: \&#34;MAC\&#34;, \&#34;goog:chromeOptions\&#34;: {\&#34;binary\&#34;: \&#34;/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta\&#34;}}&#34;</span>
<span style=color:#000;font-weight:700>[[</span><span style=color:#000>node</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>driver</span><span style=color:#a40000>-</span><span style=color:#000>configuration</span><span style=color:#000;font-weight:700>]]</span>
<span style=color:#000>display</span><span style=color:#a40000>-</span><span style=color:#000>name</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Chrome Dev&#34;</span>
<span style=color:#000>stereotype</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;{\&#34;browserName\&#34;: \&#34;chrome\&#34;, \&#34;browserVersion\&#34;: \&#34;95\&#34;, \&#34;platformName\&#34;: \&#34;MAC\&#34;, \&#34;goog:chromeOptions\&#34;: {\&#34;binary\&#34;: \&#34;/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev\&#34;}}&#34;</span>
<span style=color:#000>webdriver</span><span style=color:#a40000>-</span><span style=color:#000>executable</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#39;/path/to/chromedriver/95/chromedriver&#39;</span>
</code></pre></div><h3 id=standalone-or-node-with-docker>Standalone or Node with Docker</h3><p>A Standalone or Node server that is able to run each new session in a Docker container. Disabling
drivers detection, having maximum 2 concurrent sessions. Stereotypes configured need to be mapped
to a Docker image, and the Docker daemon needs to be exposed via http/tcp.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=color:#000;font-weight:700>[</span><span style=color:#000>node</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>detect</span><span style=color:#a40000>-</span><span style=color:#000>drivers</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span>
<span style=color:#000>max</span><span style=color:#a40000>-</span><span style=color:#000>sessions</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>2</span>

<span style=color:#000;font-weight:700>[</span><span style=color:#000>docker</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>configs</span> <span style=color:#000;font-weight:700>=</span> 
    <span style=color:#000;font-weight:700>[</span>
        <span style=color:#4e9a06>&#34;selenium/standalone-chrome:93.0&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;{\&#34;browserName\&#34;: \&#34;chrome\&#34;, \&#34;browserVersion\&#34;: \&#34;91\&#34;}&#34;</span><span style=color:#000;font-weight:700>,</span> 
        <span style=color:#4e9a06>&#34;selenium/standalone-firefox:92.0&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;{\&#34;browserName\&#34;: \&#34;firefox\&#34;, \&#34;browserVersion\&#34;: \&#34;92\&#34;}&#34;</span>
    <span style=color:#000;font-weight:700>]</span>
<span style=color:#000>url</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;http://localhost:2375&#34;</span>
<span style=color:#000>video</span><span style=color:#a40000>-</span><span style=color:#000>image</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;selenium/video:latest&#34;</span>
</code></pre></div><h3 id=relaying-commands-to-a-service-endpoint-that-supports-webdriver>Relaying commands to a service endpoint that supports WebDriver</h3><p>It is useful to connect an external service that supports WebDriver to Selenium Grid.
An example of such service could be a cloud provider or an Appium server. In this way,
Grid can enable more coverage to platforms and versions not present locally.</p><p>The following is an en example of connecting an Appium server to Grid.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=color:#000;font-weight:700>[</span><span style=color:#000>server</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>port</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>5555</span>

<span style=color:#000;font-weight:700>[</span><span style=color:#000>node</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>detect</span><span style=color:#a40000>-</span><span style=color:#000>drivers</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span>

<span style=color:#000;font-weight:700>[</span><span style=color:#000>relay</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#8f5902;font-style:italic># Default Appium server endpoint</span>
<span style=color:#000>url</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;http://localhost:4723/wd/hub&#34;</span>
<span style=color:#000>status</span><span style=color:#a40000>-</span><span style=color:#000>endpoint</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/status&#34;</span>
<span style=color:#8f5902;font-style:italic># Stereotypes supported by the service</span>
<span style=color:#000>configs</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span>
  <span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;{\&#34;browserName\&#34;: \&#34;chrome\&#34;, \&#34;platformName\&#34;: \&#34;android\&#34;, \&#34;appium:platformVersion\&#34;: \&#34;11\&#34;}&#34;</span>
<span style=color:#000;font-weight:700>]</span>
</code></pre></div><h3 id=basic-auth-enabled>Basic auth enabled</h3><p>It is possible to protect a Grid with basic auth by configuring the Router/Hub/Standalone with
a username and password. This user/password combination will be needed when loading the Grid UI
or starting a new session.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=color:#000;font-weight:700>[</span><span style=color:#000>router</span><span style=color:#000;font-weight:700>]</span>
<span style=color:#000>username</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;admin&#34;</span>
<span style=color:#000>password</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;myStrongPassword&#34;</span>
</code></pre></div><p>Here is a Java example showing how to start a session using the configured user and password.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#000>URL</span> <span style=color:#000>gridUrl</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>URL</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;http://admin:myStrongPassword@localhost:4444&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
<span style=color:#000>RemoteWebDriver</span> <span style=color:#000>webDriver</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>RemoteWebDriver</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>gridUrl</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ChromeOptions</span><span style=color:#ce5c00;font-weight:700>());</span>
</code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-9586edf2b9ce7e57a4873d12c1cb49bf>4 - 高级功能</h1><div class=lead>要获得高级功能的所有详细信息, 了解其工作原理, 以及如何设置自己的功能, 请浏览以下部分.</div></div><div class=td-content><h1 id=pg-58fa36fce0115e0cac81fa0157f35027>4.1 - Observability</h1><div class="pageinfo pageinfo-warning"><p class=lead><i class="fas fa-language display-4"></i>
Page being translated from
English to Chinese. Do you speak Chinese? Help us to translate
it by sending us pull requests!</p></div><h2 id=table-of-contents>Table of Contents</h2><ul><li><a href=#selenium-grid>Selenium Grid</a></li><li><a href=#observability>Observability</a><ul><li><a href=#distributed-tracing>Distributed tracing</a></li><li><a href=#event-logging>Event logging</a></li></ul></li><li><a href=#grid-observability>Grid Observability</a><ul><li><a href=#visualizing-traces>Visualizing Traces</a></li><li><a href=#leveraging-event-logs>Leveraging event logs</a></li></ul></li><li><a href=#references>References</a></li></ul><h2 id=selenium-grid>Selenium Grid</h2><p>Grid aids in scaling and distributing tests by executing tests on various browser and operating system combinations.</p><h2 id=observability>Observability</h2><p>Observability has three pillars: traces, metrics and logs. Since Selenium Grid 4 is designed to be fully distributed, observability will make it easier to understand and debug the internals.</p><h2 id=distributed-tracing>Distributed tracing</h2><p>A single request or transaction spans multiple services and components. Tracing tracks the request lifecycle as each service executes the request. It is useful in debugging in an error scenario.
Some key terms used in tracing context are:</p><p><strong>Trace</strong>
Tracing allows one to trace a request through multiple services, starting from its origin to its final destination. This request&rsquo;s journey helps in debugging, monitoring the end-to-end flow, and identifying failures. A trace depicts the end-to-end request flow. Each trace has a unique id as its identifier.</p><p><strong>Span</strong>
Each trace is made up of timed operations called spans. A span has a start and end time and it represents operations done by a service. The granularity of span depends on how it is instrumented. Each span has a unique identifier. All spans within a trace have the same trace id.</p><p><strong>Span Attributes</strong>
Span attributes are key-value pairs which provide additional information about each span.</p><p><strong>Events</strong>
Events are timed-stamped logs within a span. They provide additional context to the existing spans. Events also contain key-value pairs as event attributes.</p><h2 id=event-logging>Event logging</h2><p>Logging is essential to debug an application. Logging is often done in a human-readable format. But for machines to search and analyze the logs, it has to have a well-defined format. Structured logging is a common practice of recording logs consistently in a fixed format. It commonly contains fields like:</p><ul><li>Timestamp</li><li>Logging level</li><li>Logger class</li><li>Log message (This is further broken down into fields relevant to the operation where the log was recorded)</li></ul><p>Logs and events are closely related. Events encapsulate all the possible information available to do a single unit of work. Logs are essentially subsets of an event. At the crux, both aid in debugging.
Refer following resources for detailed understanding:</p><ol><li><a href=https://www.honeycomb.io/blog/how-are-structured-logs-different-from-events/>https://www.honeycomb.io/blog/how-are-structured-logs-different-from-events/</a></li><li><a href=https://charity.wtf/2019/02/05/logs-vs-structured-events/>https://charity.wtf/2019/02/05/logs-vs-structured-events/</a></li></ol><h2 id=grid-observability>Grid Observability</h2><p>Selenium server is instrumented with tracing using OpenTelemetry. Every request to the server is traced from start to end. Each trace consists of a series of spans as a request is executed within the server.
Most spans in the Selenium server consist of two events:</p><ol><li>Normal event - records all information about a unit of work and marks successful completion of the work.</li><li>Error event - records all information till the error occurs and then records the error information. Marks an exception event.</li></ol><p>Running Selenium server</p><ol><li><a href=https://github.com/SeleniumHQ/selenium/wiki/Selenium-Grid-4#standalone-mode>Standalone</a></li><li><a href=https://github.com/SeleniumHQ/selenium/wiki/Selenium-Grid-4#hub-and-node>Hub and Node</a></li><li><a href=https://github.com/SeleniumHQ/selenium/wiki/Selenium-Grid-4#fully-distributed>Fully Distributed</a></li><li><a href=https://github.com/SeleniumHQ/selenium/wiki/Selenium-Grid-4#using-docker>Docker</a></li></ol><h2 id=visualizing-traces>Visualizing Traces</h2><p>All spans, events and their respective attributes are part of a trace. Tracing works while running the server in all of the above-mentioned modes.</p><p>By default, tracing is enabled in the Selenium server. Selenium server exports the traces via two exporters:</p><ol><li>Console - Logs all traces and their included spans at FINE level. By default, Selenium server prints logs at INFO level and above.
The <strong>log-level</strong> flag can be used to pass a logging level of choice while running the Selenium Grid jar/s.</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-4.0.0-&lt;selenium-version&gt;.jar standalone --log-level FINE
</code></pre></div><ol start=2><li>Jaeger UI - OpenTelemetry provides the APIs and SDKs to instrument traces in the code. Whereas Jaeger is a tracing backend, that aids in collecting the tracing telemetry data and providing querying, filtering and visualizing features for the data.</li></ol><p>Detailed instructions of visualizing traces using Jaeger UI can be obtained by running the command :</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>java -jar selenium-server-4.0.0-&lt;selenium-version&gt;.jar info tracing
</code></pre></div><p><a href=https://github.com/manoj9788/tracing-selenium-grid>A very good example and scripts to run the server and send traces to Jaeger</a></p><h2 id=leveraging-event-logs>Leveraging event logs</h2><p>Tracing has to be enabled for event logging as well, even if one does not wish to export traces to visualize them.<br><strong>By default, tracing is enabled. No additional parameters need to be passed to see logs on the console.</strong>
All events within a span are logged at FINE level. Error events are logged at WARN level.</p><p>All event logs have the following fields :</p><table><thead><tr><th>Field</th><th>Field value</th><th>Description</th></tr></thead><tbody><tr><td>Event time</td><td>eventId</td><td>Timestamp of the event record in epoch nanoseconds.</td></tr><tr><td>Trace Id</td><td>tracedId</td><td>Each trace is uniquely identified by a trace id.</td></tr><tr><td>Span Id</td><td>spanId</td><td>Each span within a trace is uniquely identified by a span id.</td></tr><tr><td>Span Kind</td><td>spanKind</td><td>Span kind is a property of span indicating the type of span. It helps in understanding the nature of the unit of work done by the Span.</td></tr><tr><td>Event name</td><td>eventName</td><td>This maps to the log message.</td></tr><tr><td>Event attributes</td><td>eventAttributes</td><td>This forms the crux of the event logs, based on the operation executed, it has JSON formatted key-value pairs. This also includes a handler class attribute, to show the logger class.</td></tr></tbody></table><p>Sample log</p><pre><code>FINE [LoggingOptions$1.lambda$export$1] - {
  &quot;traceId&quot;: &quot;fc8aef1d44b3cc8bc09eb8e581c4a8eb&quot;,
  &quot;spanId&quot;: &quot;b7d3b9865d3ddd45&quot;,
  &quot;spanKind&quot;: &quot;INTERNAL&quot;,
  &quot;eventTime&quot;: 1597819675128886121,
  &quot;eventName&quot;: &quot;Session request execution complete&quot;,
  &quot;attributes&quot;: {
    &quot;http.status_code&quot;: 200,
    &quot;http.handler_class&quot;: &quot;org.openqa.selenium.grid.router.HandleSession&quot;,
    &quot;http.url&quot;: &quot;\u002fsession\u002fdd35257f104bb43fdfb06242953f4c85&quot;,
    &quot;http.method&quot;: &quot;DELETE&quot;,
    &quot;session.id&quot;: &quot;dd35257f104bb43fdfb06242953f4c85&quot;
  }
}
</code></pre><p>In addition to the above fields, based on <a href=https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/trace/semantic_conventions/exceptions.md>OpenTelemetry specification</a> error logs consist of :</p><table><thead><tr><th>Field</th><th>Field value</th><th>Description</th></tr></thead><tbody><tr><td>Exception type</td><td>exception.type</td><td>The class name of the exception.</td></tr><tr><td>Exception message</td><td>exception.message</td><td>Reason for the exception.</td></tr><tr><td>Exception stacktrace</td><td>exception.stacktrace</td><td>Prints the call stack at the point of time when the exception was thrown. Helps in understanding the origin of the exception.</td></tr></tbody></table><p>Sample error log</p><pre><code>WARN [LoggingOptions$1.lambda$export$1] - {
  &quot;traceId&quot;: &quot;7efa5ea57e02f89cdf8de586fe09f564&quot;,
  &quot;spanId&quot;: &quot;914df6bc9a1f6e2b&quot;,
  &quot;spanKind&quot;: &quot;INTERNAL&quot;,
  &quot;eventTime&quot;: 1597820253450580272,
  &quot;eventName&quot;: &quot;exception&quot;,
  &quot;attributes&quot;: {
    &quot;exception.type&quot;: &quot;org.openqa.selenium.ScriptTimeoutException&quot;,
    &quot;exception.message&quot;: &quot;Unable to execute request: java.sql.SQLSyntaxErrorException: Table 'mysql.sessions_mappa' doesn't exist ...&quot; (full message will be printed),
    &quot;exception.stacktrace&quot;: &quot;org.openqa.selenium.ScriptTimeoutException: java.sql.SQLSyntaxErrorException: Table 'mysql.sessions_mappa' doesn't exist\nBuild info: version: '4.0.0-alpha-7', revision: 'Unknown'\nSystem info: host: 'XYZ-MacBook-Pro.local', ip: 'fe80:0:0:0:10d5:b63a:bdc6:1aff%en0', os.name: 'Mac OS X', os.arch: 'x86_64', os.version: '10.13.6', java.version: '11.0.7'\nDriver info: driver.version: unknown ....&quot; (full stack will be printed),
    &quot;http.handler_class&quot;: &quot;org.openqa.selenium.grid.distributor.remote.RemoteDistributor&quot;,
    &quot;http.url&quot;: &quot;\u002fsession&quot;,
    &quot;http.method&quot;: &quot;POST&quot;
  }
}
</code></pre><p>Note: Logs are pretty printed above for readability. Pretty printing for logs is turned off in Selenium server.</p><p>The steps above should set you up for seeing traces and logs.</p><h2 id=references>References</h2><ol><li><a href=https://lightstep.com/blog/opentelemetry-101-what-is-tracing/>Understanding Tracing</a></li><li><a href=https://github.com/open-telemetry/opentelemetry-specification/blob/master/specification/trace/api.md#status>OpenTelemetry Tracing API Specification</a></li><li><a href=https://github.com/SeleniumHQ/selenium/wiki>Selenium Wiki</a></li><li><a href=https://www.honeycomb.io/blog/how-are-structured-logs-different-from-events/>Structured logs vs events</a></li><li><a href=https://github.com/jaegertracing/jaeger>Jaeger framework</a></li></ol></div><div class=td-content style=page-break-before:always><h1 id=pg-5accfc3d64bfa8a3f37b3a48872e2e2d>4.2 - GraphQL查询支持</h1><p>GraphQL 是一种用于API的查询语言, 也是用于使用现有数据完成这些查询的运行时. 其仅仅是使用户能够准确地获取所需.</p><h2 id=枚举>枚举</h2><p>枚举是表示字段的可能值的集合.</p><p>例如, <code>Node</code>对象具有一个称为<code>status</code>的字段. 状态是一个枚举 (特别是<code>Status</code>类型) , 因为它可能是<code>UP</code> , <code>DRAINING</code> 或 <code>UNAVAILABLE</code>.</p><h2 id=标量>标量</h2><p>标量是基本类型的值: <code>Int</code>, <code>Float</code>, <code>String</code>, <code>Boolean</code>, 或 <code>ID</code>.</p><p>在调用GraphQL API时, 必须指定嵌套子字段, 直到只返回标量.</p><h2 id=模式的结构>模式的结构</h2><p>网格模式的结构如下:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#ce5c00;font-weight:700>{</span>
    session<span style=color:#ce5c00;font-weight:700>(</span>id: <span style=color:#4e9a06>&#34;&lt;session-id&gt;&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> : <span style=color:#ce5c00;font-weight:700>{</span>
        id,
        capabilities,
        startTime,
        uri,
        nodeId,
        nodeUri,
        sessionDurationMillis
        slot : <span style=color:#ce5c00;font-weight:700>{</span>
            id,
            stereotype,
            lastStarted
        <span style=color:#ce5c00;font-weight:700>}</span>
    <span style=color:#ce5c00;font-weight:700>}</span>
    grid: <span style=color:#ce5c00;font-weight:700>{</span>
        uri,
        totalSlots,
        nodeCount,
        maxSession,
        sessionCount,
        version,
        sessionQueueSize
    <span style=color:#ce5c00;font-weight:700>}</span>
    sessionsInfo: <span style=color:#ce5c00;font-weight:700>{</span>
        sessionQueueRequests,
        sessions: <span style=color:#ce5c00;font-weight:700>[</span>
            <span style=color:#ce5c00;font-weight:700>{</span>
                id,
                capabilities,
                startTime,
                uri,
                nodeId,
                nodeUri,
                sessionDurationMillis
                slot : <span style=color:#ce5c00;font-weight:700>{</span>
                    id,
                    stereotype,
                    lastStarted
                <span style=color:#ce5c00;font-weight:700>}</span>
            <span style=color:#ce5c00;font-weight:700>}</span>
        <span style=color:#ce5c00;font-weight:700>]</span>
    <span style=color:#ce5c00;font-weight:700>}</span>
    nodesInfo: <span style=color:#ce5c00;font-weight:700>{</span>
        nodes : <span style=color:#ce5c00;font-weight:700>[</span>
            <span style=color:#ce5c00;font-weight:700>{</span>
                id,
                uri,
                status,
                maxSession,
                slotCount,
                sessions: <span style=color:#ce5c00;font-weight:700>[</span>
                    <span style=color:#ce5c00;font-weight:700>{</span>
                        id,
                        capabilities,
                        startTime,
                        uri,
                        nodeId,
                        nodeUri,
                        sessionDurationMillis
                        slot : <span style=color:#ce5c00;font-weight:700>{</span>
                            id,
                            stereotype,
                            lastStarted
                        <span style=color:#ce5c00;font-weight:700>}</span>
                    <span style=color:#ce5c00;font-weight:700>}</span>
                <span style=color:#ce5c00;font-weight:700>]</span>,
                sessionCount,
                stereotypes,
                version,
                osInfo: <span style=color:#ce5c00;font-weight:700>{</span>
                    arch,
                    name,
                    version
                <span style=color:#ce5c00;font-weight:700>}</span>
            <span style=color:#ce5c00;font-weight:700>}</span>
        <span style=color:#ce5c00;font-weight:700>]</span>
    <span style=color:#ce5c00;font-weight:700>}</span>
<span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><h2 id=查询-graphql>查询 GraphQL</h2><p>查询GraphQL的最佳方法是使用<code>curl</code>请求. GraphQL允许您仅获取所需的数据, 仅此而已.</p><p>下面给出了一些GraphQL查询的示例. 您可以根据需要构建自己的查询.</p><h3 id=查询网格中-maxsession-和-sessioncount-的数量>查询网格中 <code>maxSession</code> 和 <code>sessionCount</code> 的数量:</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;: &#34;{ grid { maxSession, sessionCount } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><p>通常在本地机器上 <code>&lt;LINK_TO_GRAPHQL_ENDPOINT></code> 会是 <code>http://localhost:4444/graphql</code></p><h3 id=查询全部会话及节点以及网格的详情->查询全部会话、及节点以及网格的详情 :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;:&#34;{ grid { uri, maxSession, sessionCount }, nodesInfo { nodes { id, uri, status, sessions { id, capabilities, startTime, uri, nodeId, nodeUri, sessionDurationMillis, slot { id, stereotype, lastStarted } }, slotCount, sessionCount }} }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=查询以获取当前网格的会话总数->查询以获取当前网格的会话总数 :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;:&#34;{ grid { sessionCount } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=查询以获取网格中的最大会话数量->查询以获取网格中的最大会话数量 :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;:&#34;{ grid { maxSession } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=查询以获取网格中所有节点的全部会话详情->查询以获取网格中所有节点的全部会话详情 :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;:&#34;{ sessionsInfo { sessions { id, capabilities, startTime, uri, nodeId, nodeId, sessionDurationMillis } } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=查询以获取网格中每个节点中所有会话的插槽信息->查询以获取网格中每个节点中所有会话的插槽信息 :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;:&#34;{ sessionsInfo { sessions { id, slot { id, stereotype, lastStarted } } } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=查询以获取给定会话的会话信息查询以获取给定会话的会话信息->查询以获取给定会话的会话信息查询以获取给定会话的会话信息 :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;:&#34;{ session (id: &#34;&lt;session-id&gt;&#34;) { id, capabilities, startTime, uri, nodeId, nodeUri, sessionDurationMillis, slot { id, stereotype, lastStarted } } } &#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=查询网格中每个节点的功能->查询网格中每个节点的功能 :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;: &#34;{ nodesInfo { nodes { stereotypes } } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=查询网格中每个节点的状态->查询网格中每个节点的状态 :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;: &#34;{ nodesInfo { nodes { status } } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=查询每个节点和网格的-uri->查询每个节点和网格的 URI :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;: &#34;{ nodesInfo { nodes { uri } } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=query-for-getting-the-current-requests-in-the-new-session-queue>Query for getting the current requests in the New Session Queue:</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;:&#34;{ sessionsInfo { sessionQueueRequests } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div><h3 id=query-for-getting-the-new-session-queue-size->Query for getting the New Session Queue size :</h3><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/json&#34;</span> --data <span style=color:#4e9a06>&#39;{&#34;query&#34;:&#34;{ grid { sessionQueueSize } }&#34;}&#39;</span> -s &lt;LINK_TO_GRAPHQL_ENDPOINT&gt;
</code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-1e74293b60642ddab77bb57253bc8cce>4.3 - Grid端点</h1><h2 id=grid>Grid</h2><h3 id=grid-状态>Grid 状态</h3><p>Grid状态提供Grid的当前状态.
它包含每个注册节点的详细信息.
对于每个节点,
状态包括有关节点可用性、会话和插槽的信息.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL GET <span style=color:#4e9a06>&#39;http://localhost:4444/status&#39;</span>
</code></pre></div><p>在独立模式下, Grid URL是独立服务器的地址.</p><p>在集线器节点模式下, Grid URL是集线器服务器的地址.</p><p>在完全分布式模式下, Grid URL是路由服务器的地址.</p><p>以上所有模式的默认URL皆为http://localhost:4444.</p><h2 id=分发器>分发器</h2><h3 id=删除节点>删除节点</h3><p>要从Grid中删除节点,
请使用下面列出的cURL命令.
它不会停止在该节点上运行的任何持续中的会话.
除非显式终止, 否则节点将继续按原样运行.
分发器不再知晓该节点,
因此任何匹配的新会话请求
也不会转发到该节点.</p><p>在独立模式下, 分发器URL是独立服务器的地址.</p><p>在集线器节点模式下, 分发器URL是集线器服务器的地址.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request DELETE <span style=color:#4e9a06>&#39;http://localhost:4444/se/grid/distributor/node/&lt;node-id&gt;&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET: &lt;secret&gt; &#39;</span>
</code></pre></div><p>在完全分布式模式下, URL是分发器的地址.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request DELETE <span style=color:#4e9a06>&#39;http://localhost:5553/se/grid/distributor/node/&lt;node-id&gt;&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET: &lt;secret&gt;&#39;</span>
</code></pre></div><p>如果在设置Grid时未配置注册密码,
则使用</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request DELETE <span style=color:#4e9a06>&#39;http://&lt;Distributor-URL&gt;/se/grid/distributor/node/&lt;node-id&gt;&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET;&#39;</span>
</code></pre></div><h3 id=放空节点>放空节点</h3><p>节点放空命令用于优雅地关闭节点.
放空节点将在所有持续中的会话完成后停止节点.
但是, 它不接受任何新的会话请求.</p><p>在独立模式下, 分发器URL是独立服务器的地址.</p><p>在集线器节点模式下, 分发器URL是集线器服务器的地址.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request POST <span style=color:#4e9a06>&#39;http://localhost:4444/se/grid/distributor/node/&lt;node-id&gt;/drain&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET: &lt;secret&gt; &#39;</span>
</code></pre></div><p>在完全分布式模式下, URL是分发服务器的地址.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request POST <span style=color:#4e9a06>&#39;http://localhost:5553/se/grid/distributor/node/&lt;node-id&gt;/drain&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET: &lt;secret&gt;&#39;</span>
</code></pre></div><p>如果在设置Grid时未配置注册密码,
则使用</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request POST <span style=color:#4e9a06>&#39;http://&lt;Distributor-URL&gt;/se/grid/distributor/node/&lt;node-id&gt;/drain&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET;&#39;</span>
</code></pre></div><h2 id=节点>节点</h2><p>本节中的端点适用于
集线器节点模式和
节点独立运行的完全分布式网格模式.
在一个节点的情况下, 默认节点的URL为 http://localhost:5555 .
如果有多个节点,
请使用 <a href=#grid-%E7%8A%B6%E6%80%81>Grid 状态</a> 获取所有节点详细信息
以及定位地址.</p><h3 id=状态>状态</h3><p>节点状态本质上是节点的运行状况检查.
分发器定期ping节点状态，
并相应地更新Grid模型.
状态包括相关的可用性, 会话和插槽的信息.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request GET <span style=color:#4e9a06>&#39;http://localhost:5555/status&#39;</span>
</code></pre></div><h3 id=放空>放空</h3><p>分发器将 <a href=#%E6%94%BE%E7%A9%BA%E8%8A%82%E7%82%B9>放空</a> 命令传递给
由node-id标识的相应节点.
要直接放空节点,
请使用下面列出的cuRL命令.
两个端点都有效并产生相同的结果.
放空会等待持续中的会话完成后
才停止节点.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request POST <span style=color:#4e9a06>&#39;http://localhost:5555/se/grid/node/drain&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET: &lt;secret&gt;&#39;</span>
</code></pre></div><p>如果在设置Grid时未配置注册密码,
则使用</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request POST <span style=color:#4e9a06>&#39;http://&lt;node-URL&gt;/se/grid/node/drain&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET;&#39;</span>
</code></pre></div><h3 id=检查会话所有者>检查会话所有者</h3><p>要检查会话是否属于某一节点, 请使用下面列出的cURL命令.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request GET <span style=color:#4e9a06>&#39;http://localhost:5555/se/grid/node/owner/&lt;session-id&gt;&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET: &lt;secret&gt;&#39;</span>
</code></pre></div><p>如果在设置Grid时未配置注册密码,
则使用</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request GET <span style=color:#4e9a06>&#39;http://&lt;node-URL&gt;/se/grid/node/owner/&lt;session-id&gt;&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET;&#39;</span>
</code></pre></div><p>如果会话属于该节点,
则返回true,
否则返回false.</p><h3 id=删除会话>删除会话</h3><p>删除会话将终止WebDriver会话,
退出驱动程序
并将其从活动会话集合中删除.
任何使用删除的会话id
或重用驱动程序实例的请求
都将抛出错误.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request DELETE <span style=color:#4e9a06>&#39;http://localhost:5555/se/grid/node/session/&lt;session-id&gt;&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET: &lt;secret&gt;&#39;</span>
</code></pre></div><p>如果在设置Grid时未配置注册密码,
则使用</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request DELETE <span style=color:#4e9a06>&#39;http://&lt;node-URL&gt;/se/grid/node/session/&lt;session-id&gt;&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET;&#39;</span>
</code></pre></div><h2 id=新会话队列>新会话队列</h2><h3 id=清除新会话队列>清除新会话队列</h3><p>新会话请求队列保存新会话请求.
要清除队列,
请使用下面列出的cURL命令.
清除队列将拒绝队列中的所有请求.
对于每个这样的请求,
服务器都会向相应的客户端返回一个错误响应.
清除命令的返回结果是
已删除请求的总数.</p><p>在独立模式下, 队列URL是独立服务器的地址.
在集线器节点模式下, 队列URL是集线器服务器的地址.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request DELETE <span style=color:#4e9a06>&#39;http://localhost:4444/se/grid/newsessionqueue/queue&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET: &lt;secret&gt;&#39;</span>
</code></pre></div><p>在完全分布式模式下,
队列URL是新会话队列服务器的地址.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request DELETE <span style=color:#4e9a06>&#39;http://localhost:5559/se/grid/newsessionqueue/queue&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET: &lt;secret&gt;&#39;</span>
</code></pre></div><p>如果在设置Grid时未配置注册密码,
则使用</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request DELETE <span style=color:#4e9a06>&#39;http://&lt;URL&gt;/se/grid/newsessionqueue/queue&#39;</span> --header <span style=color:#4e9a06>&#39;X-REGISTRATION-SECRET;&#39;</span>
</code></pre></div><h3 id=获取新会话队列请求>获取新会话队列请求</h3><p>New Session Request Queue holds the new session requests.
To get the current requests in the queue, use the cURL command enlisted below.
The response returns the total number of requests in the queue and the request payloads.
新会话请求队列保存新会话请求.
要获取队列中的当前请求,
请使用下面列出的cURL命令.
响应会返回队列中的请求总数以及请求内容.</p><p>在独立模式下, 队列URL是独立服务器的地址.
在集线器节点模式下, 队列URL是集线器服务器的地址.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request GET <span style=color:#4e9a06>&#39;http://localhost:4444/se/grid/newsessionqueue/queue&#39;</span>
</code></pre></div><p>在完全分布式模式下,
队列URL是新会话队列服务器的地址.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cURL --request GET <span style=color:#4e9a06>&#39;http://localhost:5559/se/grid/newsessionqueue/queue&#39;</span>
</code></pre></div></div><div class=td-content style=page-break-before:always><h1 id=pg-0dfead81648fd92f1f69064ff55127bf>5 - 什么时候应该使用服务网格</h1><div class=lead>Is Grid the right tool for you?</div><div class="pageinfo pageinfo-warning"><p class=lead><i class="fas fa-language display-4"></i>
Page being translated from
English to Chinese. Do you speak Chinese? Help us to translate
it by sending us pull requests!</p></div><p>通常来说，有2个原因你需要使用服务网格。</p><ul><li>在多种浏览器，多种版本的浏览器，不同操作系统里的浏览器里执行你的测试</li><li>缩短完成测试的时间</li></ul><p>服务网格通过使用多台终端机器来并行执行测试，以达到加速测试执行的目的。
比如的测试套件里包含100个测试，你的服务网格支持4种不同的终端（虚拟机或者独立的物理设备）
来执行这些测试，相比你只有一台终端来执行，你的测试套件只需要4分之1的时间。
在一些大型测试套件，或者一些长时间执行的测试比如执行大量的数据校验，这样做会节约大量的时间。
一些测试会需要几个小时。另一个改善的动力来自缩短这种耗时的测试的是为了开发人员从提交代码到获得测试结果的期间。软件开发团队实践敏捷开发时期望尽可能早的得到测试反馈，而不是一晚一晚的等测试通过。</p><p>服务网格也会被用来支持在不同的运行环境的测试，比如，在同一实践针对不同浏览器的测试。
比如，一个由虚拟机组成的服务网格，每一个终端机可以支持一个不同的应用程序需要支持的浏览器。
比如终端1有IE8，终端2有IE9，终端3有最新的Chrmoe，终端4有最新的Firefox。当所有的测试套件都执行了，
Selenium服务网格会接受每个测试浏览器组合的要求，然后安排每个测试被执行在所要求的浏览器上。</p><p>另外，一个服务网格可以包含同样的浏览器，类型，版本。比如，你可以有一个包含4台终端，没个终端包含3个
Firefox70的实例的网格，提供了一个服务器集群提供可用的Firefox实例。当测试套件被执行的时候，每个被提交进服务网格的测试会被分发到可用的Firefox实例。在这个情况下，同一时间可以有12个测试被并行的执行，
显著的缩短的整个测试完成的时间。</p><p>服务网格是弹性的。这2个例子可以被组合来创建多种实例的浏览器和版本。通过配置，可以提供并行执行以加速测试，或者支持多种浏览器版本的模拟2中能力。</p></div></main></div></div><div class="row justify-content-center p-5"><h2 class="selenium text-center">Selenium Level Sponsors</h2></div><div class="row justify-content-around pt-4 pb-5 px-5"><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="http://www.browserstack.com/automate/?utm_campaign=open-source-sponsor&utm_source=seleniumorg&utm_medium=referral" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/browserstack.png alt=BrowserStack></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=http://saucelabs.com class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/saucelabs.png alt="Sauce Labs"></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=http://bit.ly/36uZ7ad class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/experitest.png alt=Experitest></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=https://applitools.com/ class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/applitools.png alt=Applitools></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=https://www.perfecto.io/ class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/perfecto-perforce.jpg alt=Perfecto></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href=https://www.lambdatest.com/selenium-automation class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/lambda-test.png alt=LambdaTest></a></div><div class="col-lg-3 col-md-6 mb-4 mb-lg-0 align-self-center px-5 py-3"><a href="https://www.subject-7.com/?utm_source=SeleniumHQ&utm_medium=referral&utm_campaign=product" class=border-0><img class="w-100 shadow-1-strong rounded selenium-backer-logo" src=/images/sponsors/subject7_logo.png alt=Subject7></a></div></div><div class="row justify-content-center pt-2 pb-3 -bg-selenium-cyan"><div class="card text-center border-0 bg-transparent py-5"><div class=card-body><h2 class=card-title>Support the Selenium Project</h2><p class=card-text></p><div class=selenium-button-container><a href=/sponsors class="selenium-button selenium-white-cyan text-uppercase font-weight-bold">Learn more
<i class="pl-3 fas fa-caret-right"></i></a></div></div></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/group/selenium-users aria-label="User mailing list"><i class="fas fa-mail-bulk"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Selenium in Twitter" aria-label="Selenium in Twitter"><a class=text-white target=_blank rel=noopener href=https://twitter.com/SeleniumHQ aria-label="Selenium in Twitter"><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="SeleniumConf YouTube Channel" aria-label="SeleniumConf YouTube Channel"><a class=text-white target=_blank rel=noopener href=https://www.youtube.com/channel/UCbDlgX_613xNMrDqCe3QNEw aria-label="SeleniumConf YouTube Channel"><i class="fab fa-youtube"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Selenium in Facebook" aria-label="Selenium in Facebook"><a class=text-white target=_blank rel=noopener href=https://www.facebook.com/Selenium2.WebDriver aria-label="Selenium in Facebook"><i class="fab fa-facebook"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Software Freedom Conservancy" aria-label="Software Freedom Conservancy"><a class=text-white target=_blank rel=noopener href=mailto:selenium@sfconservancy.org aria-label="Software Freedom Conservancy"><i class="fas fa-envelope-square"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/seleniumhq/selenium aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://join.slack.com/t/seleniumhq/shared_invite/zt-vv33sc0w-VKKQop3WDV_lfrLXGGHvDw aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=IRC aria-label=IRC><a class=text-white target=_blank rel=noopener href=https://kiwiirc.com/nextclient/irc.libera.chat/#selenium aria-label=IRC><i class="fas fa-comments"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel=noopener href=https://groups.google.com/g/selenium-developers aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2021 Software Freedom Conservancy All Rights Reserved</small><p class=mt-2><a href=/zh-cn/documentation/about/>关于这个文档</a></p></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script><script src=/js/main.min.5c74b870c6953931a705f390a49c7e4c0a842ec5c83b24354758dd674343ed0d.js integrity="sha256-XHS4cMaVOTGnBfOQpJx+TAqELsXIOyQ1R1jdZ0ND7Q0=" crossorigin=anonymous></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js></script><script type=text/javascript>docsearch({apiKey:'f6cea044c21fee6ae07b0b090bf2ca6a',indexName:'selenium',inputSelector:'.td-search-input',debug:!1})</script></body></html>